AWSTemplateFormatVersion: '2010-09-09'
Description: 'Step 6.1: Secrets Manager for Aurora Global Database (Virginia)'

Resources:
  # 1. The Database Secret
  AuroraSecret:
    Type: AWS::SecretsManager::Secret
    Properties:
      # Naming it clearly so our scripts can find it
      Name: "dct-us-east-1-aurora-secret"
      Description: "Credentials for the Aurora Global Database"
      # IMPORTANT: Use the same password you used in Step 6
      SecretString: !Sub '{"username":"admin","password":"Dct.Click!!"}'
      Tags:
        - Key: Project
          Value: "DCT-Active-Active"

Outputs:
  SecretArn:
    Description: "The ARN of the Aurora Secret"
    Value: !Ref AuroraSecret
    Export:
      Name: !Sub "REGION-${AWS::Region}-AURORA-SECRET-ARN"

  SecretName:
    Description: "The Name of the Aurora Secret"
    Value: !GetAtt AuroraSecret.Name
    Export:
      Name: !Sub "REGION-${AWS::Region}-AURORA-SECRET-NAME"